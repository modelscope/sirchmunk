## ---------------------------------------------------------------------------
## Sirchmunk Docker Compose
##
## Usage:
##   # Option 1: Build via build_image.py (recommended)
##   cd <project-root>
##   python docker/build_image.py                   # build image
##   docker compose -f docker/docker-compose.yml up -d
##
##   # Option 2: Generate Dockerfile + compose build
##   python docker/build_image.py --dry_run 1       # generates ./Dockerfile
##   docker compose -f docker/docker-compose.yml up -d --build
## ---------------------------------------------------------------------------

services:
  sirchmunk:
    image: ${SIRCHMUNK_IMAGE:-sirchmunk:latest}
    build:
      context: ..
      dockerfile: Dockerfile
    container_name: sirchmunk
    ports:
      - "8584:8584"
    volumes:
      # SIRCHMUNK_WORK_PATH is set to /data/sirchmunk inside the image.
      # Mount a host directory for persistence across restarts.
      - /path/to/sirchmunk_workspace:/data/sirchmunk
      # Mount local search paths (add your own paths here)
      # - /path/to/your/docs:/mnt/docs:ro
    environment:
      - LLM_BASE_URL=${LLM_BASE_URL:-https://api.openai.com/v1}
      - LLM_API_KEY=${LLM_API_KEY:-}
      - LLM_MODEL_NAME=${LLM_MODEL_NAME:-gpt-5.2}
    restart: unless-stopped
